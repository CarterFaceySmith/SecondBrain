Linux binaries are executable files compiled to run on the Linux operating system. The Executable and Linkable Format (ELF) is a common file format for [[Linux]] binaries. 

## Intro

Linux binaries are files containing machine code and data in a format that the Linux operating system can directly execute. ELF is the standard file format for executables, object code, shared libraries, and core dumps on Linux systems.

They are generated by compiling source code into an ELF object file (`.o`), which is then used by a [[Linkers]] with other ELF files to generated an ELF executable.

## Structure

- **Header**: Contains essential information about the file, such as file type, target architecture, and entry point.
- **Sections**: Segments of the file containing various data like code, data, symbols, and relocation information.
- **Segments**: Logical units for loading the program into memory, including one or more sections.
- **Symbols**: Information about functions, variables, etc., used for linking.

### Specific Sections

- **`.text`**: Contains the executable code.
- **`.data`**: Holds initialized global and static variables.
- **`.bss`**: Contains uninitialized global and static variables.
- **`.rodata`**: Holds read-only data like constants and string literals.
- **`.symtab`**: Stores symbol information.
- **`.rel.text` and `.rel.data`**: Contain relocation information for code and data.

## Manipulating ELF Files

**Viewing ELF Information**: Use tools like `readelf` to inspect ELF file information, including headers, sections, and symbols.

```bash
readelf -h your_executable  # Display ELF header 
readelf -S your_executable  # Display ELF sections`
```

- **Modifying ELF Information**: Tools like `objcopy` can modify ELF files, such as extracting sections or changing the binary format.

- **Creating Custom ELF Tools**: With appropriate knowledge, you can develop custom tools to parse and manipulate ELF files for specific purposes.

## Key ELF Linux Libraries

### Linker and Loader Libraries
#### **libelf**
- **Description**: `libelf` is a library that provides functions for reading and writing ELF files, making it essential for creating custom ELF file loaders or manipulation tools.
- **Usage**: Allows you to parse ELF structures, access segments, sections, symbols, and more.

#### **libdwarf**
- **Description**: `libdwarf` is used for reading DWARF debugging information, which is typically embedded in ELF files. It's useful for debugging and profiling applications.
- **Usage**: Provides functions to navigate and extract debugging information from ELF files.

### Libraries for ELF Manipulation
#### **libc**
- **Description**: The C standard library (`libc`) provides essential functions and utilities for various operations, including file I/O, memory allocation, string manipulation, and system calls.
- **Usage**: Utilize functions like `mmap` for memory mapping ELF files, `dlopen` for dynamic loading, and others for general file operations.

### Memory Management Libraries
#### **libmman**
- **Description**: `libmman` provides functions related to memory management, including memory mapping (`mmap`) and memory allocation (`malloc`, `calloc`, `realloc`).
- **Usage**: Use `mmap` to map ELF files into memory for efficient loading and manipulation.

### Error Handling Libraries
#### **liberr**
- **Description**: Error handling is critical in ELF file loading. Libraries like `liberr` help in robust error reporting and handling.
- **Usage**: Implement error handling strategies using functions provided by this library, such as logging and graceful degradation.

## A Practical Example

1. Grab your Assembly code
```assembly
section .data
    hello db 'Hello, ELF!',0

section .text
    global _start

_start:
    ; sys_write(int fd, const char *buf, int count)
    mov eax, 4
    mov ebx, 1
    mov ecx, hello
    mov edx, 13
    int 0x80

    ; sys_exit(int status)
    mov eax, 1
    xor ebx, ebx
    int 0x80
```

2. Assemble and link that shit

```bash
as -o example.o example.asm      # Assemble to object file
ld -m elf_i386 -s -o example example.o  # Link to create ELF executable
```

3. You're now free to analyse or use your ELF file using `readelf` or `objdump`.